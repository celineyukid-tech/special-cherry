<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数学冒险岛 - 倍数与公约数学习游戏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: #333;
        }
        
        #game-container {
            width: 100%;
            max-width: 900px;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
        }
        
        .screen {
            display: none;
            padding: 30px;
            flex-direction: column;
            height: 100%;
            min-height: 500px;
        }
        
        .active-screen {
            display: flex;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #2575fc;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.1);
        }
        
        h2 {
            color: #6a11cb;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        h3 {
            color: #2575fc;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.2rem;
        }
        
        .content {
            flex-grow: 1;
            line-height: 1.6;
            font-size: 1.1rem;
        }
        
        .lesson-content {
            background-color: #f9f9ff;
            padding: 20px;
            border-radius: 15px;
            border-left: 5px solid #6a11cb;
            margin-bottom: 20px;
        }
        
        .example {
            background-color: #eef5ff;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }
        
        .example-title {
            font-weight: bold;
            color: #2575fc;
        }
        
        .buttons-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
            justify-content: center;
        }
        
        .btn {
            padding: 15px 25px;
            font-size: 1.1rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            min-width: 180px;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        }
        
        .btn-primary {
            background: linear-gradient(to right, #6a11cb, #2575fc);
            color: white;
        }
        
        .btn-secondary {
            background-color: #f1f1f1;
            color: #333;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .question-container {
            background-color: #f9f9ff;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 2px dashed #6a11cb;
        }
        
        .question-text {
            font-size: 1.3rem;
            margin-bottom: 20px;
            font-weight: bold;
            color: #333;
        }
        
        .options-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .option {
            padding: 15px;
            background-color: white;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
        }
        
        .option:hover {
            background-color: #eef5ff;
            border-color: #2575fc;
        }
        
        .option.selected {
            background-color: #d4edda;
            border-color: #28a745;
        }
        
        .option.correct {
            background-color: #d4edda;
            border-color: #28a745;
        }
        
        .option.wrong {
            background-color: #f8d7da;
            border-color: #dc3545;
        }
        
        .feedback {
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-weight: bold;
            text-align: center;
            display: none;
        }
        
        .feedback.correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .feedback.wrong {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            background-color: #f1f1f1;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .level-info, .score-info {
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .level-info span, .score-info span {
            color: #6a11cb;
        }
        
        .progress-container {
            height: 15px;
            background-color: #e9ecef;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, #6a11cb, #2575fc);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .completion-screen {
            text-align: center;
        }
        
        .celebration {
            font-size: 4rem;
            margin: 20px 0;
        }
        
        .final-score {
            font-size: 2.5rem;
            color: #6a11cb;
            margin: 20px 0;
        }
        
        .character {
            font-size: 4rem;
            margin: 20px 0;
        }
        
        .hint {
            background-color: #fff3cd;
            padding: 10px;
            border-radius: 10px;
            margin-top: 15px;
            border-left: 4px solid #ffc107;
            font-size: 0.95rem;
            display: none;
        }
        
        .show-hint-btn {
            background-color: #ffc107;
            color: #333;
            padding: 8px 15px;
            font-size: 0.9rem;
            margin-top: 10px;
        }
        
        .special-note {
            background-color: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        
        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            h2 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- 开始屏幕 -->
        <div id="start-screen" class="screen active-screen">
            <div class="header">
                <h1>数学冒险岛</h1>
                <p class="subtitle">倍数、因数与质数学习游戏</p>
                <div class="character">🧮</div>
            </div>
            
            <div class="content">
                <p>欢迎来到数学冒险岛！在这里你将学习：</p>
                <ul style="margin: 20px; padding-left: 20px;">
                    <li>什么是倍数和因数</li>
                    <li>如何找出一个数的所有因数</li>
                    <li>什么是最小公约数和最大公约数</li>
                    <li>什么是质数和合数</li>
                </ul>
                <p>完成所有关卡，成为数学小达人！</p>
                
                <div class="lesson-content">
                    <p>本游戏专为五年级学生设计，通过有趣的关卡帮助掌握100以内的数的数学关系。</p>
                    <p>每个关卡前都有简单易懂的讲解，帮助你理解概念。</p>
                </div>
            </div>
            
            <div class="buttons-container">
                <button class="btn btn-primary" id="start-game-btn">开始游戏</button>
                <button class="btn btn-secondary" id="instructions-btn">游戏说明</button>
            </div>
        </div>
        
        <!-- 说明屏幕 -->
        <div id="instructions-screen" class="screen">
            <div class="header">
                <h2>游戏说明</h2>
            </div>
            
            <div class="content">
                <div class="lesson-content">
                    <h3>如何玩游戏</h3>
                    <p>1. 游戏共有7个关卡，难度逐渐增加</p>
                    <p>2. 每个关卡前会有知识点讲解</p>
                    <p>3. 回答正确的问题可以获得分数</p>
                    <p>4. 可以使用"提示"按钮获得帮助</p>
                    <p>5. 完成所有关卡后可以看到你的得分</p>
                </div>
                
                <div class="lesson-content">
                    <h3>学习目标</h3>
                    <p>✓ 理解倍数和因数的概念</p>
                    <p>✓ 能够找出100以内数的所有因数</p>
                    <p>✓ 理解公约数和最大公约数</p>
                    <p>✓ 能够计算两个数的最大公约数</p>
                    <p>✓ 理解质数和合数的概念</p>
                    <p>✓ 能够判断100以内的数是质数还是合数</p>
                </div>
            </div>
            
            <div class="buttons-container">
                <button class="btn btn-primary" id="back-to-start-btn">返回主菜单</button>
            </div>
        </div>
        
        <!-- 教学关卡1：倍数 -->
        <div id="lesson1-screen" class="screen">
            <div class="header">
                <h2>第一课：认识倍数</h2>
                <div class="progress-container">
                    <div class="progress-bar" id="progress1" style="width: 14%"></div>
                </div>
            </div>
            
            <div class="content">
                <div class="lesson-content">
                    <p><strong>倍数的定义：</strong>如果一个数能被另一个数整除，那么这个数就是另一个数的倍数。</p>
                    
                    <div class="example">
                        <p class="example-title">例子：</p>
                        <p>12 ÷ 3 = 4，没有余数，所以12是3的倍数。</p>
                        <p>同样，12 ÷ 4 = 3，没有余数，所以12也是4的倍数。</p>
                    </div>
                    
                    <p>我们可以用乘法来找出一个数的倍数：</p>
                    
                    <div class="example">
                        <p class="example-title">找出5的倍数：</p>
                        <p>5 × 1 = 5，所以5是5的倍数</p>
                        <p>5 × 2 = 10，所以10是5的倍数</p>
                        <p>5 × 3 = 15，所以15是5的倍数</p>
                        <p>5 × 4 = 20，所以20是5的倍数</p>
                        <p>5、10、15、20……这些都是5的倍数</p>
                    </div>
                    
                    <p>在接下来的练习中，你会练习找出100以内数的倍数。</p>
                </div>
            </div>
            
            <div class="buttons-container">
                <button class="btn btn-secondary" id="back-from-lesson1-btn">返回</button>
                <button class="btn btn-primary" id="start-level1-btn">开始练习</button>
            </div>
        </div>
        
        <!-- 关卡1：倍数练习 -->
        <div id="level1-screen" class="screen">
            <div class="header">
                <h2>第一关：倍数练习</h2>
                <div class="game-info">
                    <div class="level-info">关卡: <span>1/7</span></div>
                    <div class="score-info">分数: <span id="score1">0</span></div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar" id="level1-progress" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="content">
                <div class="question-container">
                    <div class="question-text" id="question1-text">下面哪个数是8的倍数？</div>
                    
                    <div class="options-container" id="options1-container">
                        <!-- 选项将通过JavaScript动态生成 -->
                    </div>
                    
                    <div class="feedback" id="feedback1"></div>
                    
                    <div class="hint" id="hint1">
                        提示：8的倍数可以通过8×1=8，8×2=16，8×3=24...来计算。所以8的倍数有8, 16, 24, 32, 40...
                    </div>
                    
                    <button class="btn show-hint-btn" id="show-hint1-btn">显示提示</button>
                </div>
            </div>
            
            <div class="buttons-container">
                <button class="btn btn-secondary" id="back-to-lesson1-btn">返回教学</button>
                <button class="btn btn-primary" id="check-answer1-btn">检查答案</button>
                <button class="btn btn-primary" id="next-question1-btn" style="display:none">下一题</button>
            </div>
        </div>
        
        <!-- 教学关卡2：因数 -->
        <div id="lesson2-screen" class="screen">
            <div class="header">
                <h2>第二课：认识因数</h2>
                <div class="progress-container">
                    <div class="progress-bar" id="progress2" style="width: 28%"></div>
                </div>
            </div>
            
            <div class="content">
                <div class="lesson-content">
                    <p><strong>因数的定义：</strong>如果一个数能被另一个数整除，那么另一个数就是这个数的因数。</p>
                    <p><strong>重要提示：</strong>每个数的因数都包括1和它本身！</p>
                    
                    <div class="example">
                        <p class="example-title">例子：</p>
                        <p>12 ÷ 3 = 4，没有余数，所以3是12的因数。</p>
                        <p>同样，12 ÷ 4 = 3，没有余数，所以4也是12的因数。</p>
                        <p>12 ÷ 1 = 12，所以1是12的因数。</p>
                        <p>12 ÷ 12 = 1，所以12本身也是12的因数。</p>
                    </div>
                    
                    <p>我们可以通过除法来找出一个数的所有因数：</p>
                    
                    <div class="example">
                        <p class="example-title">找出18的所有因数：</p>
                        <p>18 ÷ 1 = 18，所以1和18都是18的因数</p>
                        <p>18 ÷ 2 = 9，所以2和9都是18的因数</p>
                        <p>18 ÷ 3 = 6，所以3和6都是18的因数</p>
                        <p>18的因数有：1, 2, 3, 6, 9, 18</p>
                    </div>
                    
                    <p>在接下来的练习中，你会练习找出100以内数的因数。</p>
                </div>
            </div>
            
            <div class="buttons-container">
                <button class="btn btn-secondary" id="back-to-level1-btn">返回上一关</button>
                <button class="btn btn-primary" id="start-level2-btn">开始练习</button>
            </div>
        </div>
        
        <!-- 关卡2：因数练习 -->
        <div id="level2-screen" class="screen">
            <div class="header">
                <h2>第二关：因数练习</h2>
                <div class="game-info">
                    <div class="level-info">关卡: <span>2/7</span></div>
                    <div class="score-info">分数: <span id="score2">0</span></div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar" id="level2-progress" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="content">
                <div class="question-container">
                    <div class="question-text" id="question2-text">下面哪个数是24的因数？</div>
                    
                    <div class="options-container" id="options2-container">
                        <!-- 选项将通过JavaScript动态生成 -->
                    </div>
                    
                    <div class="feedback" id="feedback2"></div>
                    
                    <div class="hint" id="hint2">
                        提示：24的因数是可以整除24的数。我们可以通过24÷1=24，24÷2=12，24÷3=8，24÷4=6来计算。所以24的因数有1, 2, 3, 4, 6, 8, 12, 24。
                    </div>
                    
                    <button class="btn show-hint-btn" id="show-hint2-btn">显示提示</button>
                </div>
            </div>
            
            <div class="buttons-container">
                <button class="btn btn-secondary" id="back-to-lesson2-btn">返回教学</button>
                <button class="btn btn-primary" id="check-answer2-btn">检查答案</button>
                <button class="btn btn-primary" id="next-question2-btn" style="display:none">下一题</button>
            </div>
        </div>
        
        <!-- 关卡A：写出一个数的所有因数 -->
        <div id="levelA-screen" class="screen">
            <div class="header">
                <h2>第三关：找出所有因数</h2>
                <div class="game-info">
                    <div class="level-info">关卡: <span>3/7</span></div>
                    <div class="score-info">分数: <span id="scoreA">0</span></div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar" id="levelA-progress" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="content">
                <div class="question-container">
                    <div class="question-text" id="questionA-text">找出10的所有因数：</div>
                    
                    <div class="options-container" id="optionsA-container">
                        <!-- 选项将通过JavaScript动态生成 -->
                    </div>
                    
                    <div class="feedback" id="feedbackA"></div>
                    
                    <div class="hint" id="hintA">
                        提示：从1开始检查，1×10=10，所以1和10是因数。2×5=10，所以2和5是因数。3不能整除10，4不能整除10。10的因数有：1, 2, 5, 10。
                    </div>
                    
                    <button class="btn show-hint-btn" id="show-hintA-btn">显示提示</button>
                </div>
            </div>
            
            <div class="buttons-container">
                <button class="btn btn-secondary" id="back-to-level2-btn">返回上一关</button>
                <button class="btn btn-primary" id="check-answerA-btn">检查答案</button>
                <button class="btn btn-primary" id="next-questionA-btn" style="display:none">下一题</button>
            </div>
        </div>
        
        <!-- 关卡B：判断一个数有多少个因数 -->
        <div id="levelB-screen" class="screen">
            <div class="header">
                <h2>第四关：因数个数</h2>
                <div class="game-info">
                    <div class="level-info">关卡: <span>4/7</span></div>
                    <div class="score-info">分数: <span id="scoreB">0</span></div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar" id="levelB-progress" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="content">
                <div class="question-container">
                    <div class="question-text" id="questionB-text">10有多少个因数？</div>
                    
                    <div class="options-container" id="optionsB-container">
                        <!-- 选项将通过JavaScript动态生成 -->
                    </div>
                    
                    <div class="feedback" id="feedbackB"></div>
                    
                    <div class="hint" id="hintB">
                        提示：先找出10的所有因数：1, 2, 5, 10。一共有4个因数。
                    </div>
                    
                    <button class="btn show-hint-btn" id="show-hintB-btn">显示提示</button>
                </div>
            </div>
            
            <div class="buttons-container">
                <button class="btn btn-secondary" id="back-to-levelA-btn">返回上一关</button>
                <button class="btn btn-primary" id="check-answerB-btn">检查答案</button>
                <button class="btn btn-primary" id="next-questionB-btn" style="display:none">下一题</button>
            </div>
        </div>
        
        <!-- 教学关卡C：质数和合数 -->
        <div id="lessonC-screen" class="screen">
            <div class="header">
                <h2>第五课：认识质数和合数</h2>
                <div class="progress-container">
                    <div class="progress-bar" id="progressC" style="width: 71%"></div>
                </div>
            </div>
            
            <div class="content">
                <div class="lesson-content">
                    <p><strong>质数的定义：</strong>一个大于1的自然数，如果除了1和它本身以外，没有其他因数，那么这个数就是质数。</p>
                    
                    <div class="example">
                        <p class="example-title">例子：</p>
                        <p>2的因数只有1和2，所以2是质数</p>
                        <p>3的因数只有1和3，所以3是质数</p>
                        <p>5的因数只有1和5，所以5是质数</p>
                        <p>7的因数只有1和7，所以7是质数</p>
                    </div>
                    
                    <p><strong>合数的定义：</strong>一个大于1的自然数，如果除了1和它本身以外，还有其他因数，那么这个数就是合数。</p>
                    
                    <div class="example">
                        <p class="example-title">例子：</p>
                        <p>4的因数有1, 2, 4，所以4是合数</p>
                        <p>6的因数有1, 2, 3, 6，所以6是合数</p>
                        <p>8的因数有1, 2, 4, 8，所以8是合数</p>
                        <p>9的因数有1, 3, 9，所以9是合数</p>
                    </div>
                    
                    <div class="special-note">
                        <p><strong>特别注意：</strong></p>
                        <p>1既不是质数也不是合数，因为它只有一个因数（1本身）。</p>
                        <p>最小的质数是2，这也是唯一的偶数质数。</p>
                    </div>
                    
                    <p>100以内的质数有：2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97</p>
                    
                    <p>在接下来的练习中，你会练习判断100以内的数是质数还是合数。</p>
                </div>
            </div>
            
            <div class="buttons-container">
                <button class="btn btn-secondary" id="back-to-levelB-btn">返回上一关</button>
                <button class="btn btn-primary" id="start-levelC-btn">开始练习</button>
            </div>
        </div>
        
        <!-- 关卡C：判断质数或合数 -->
        <div id="levelC-screen" class="screen">
            <div class="header">
                <h2>第五关：质数还是合数？</h2>
                <div class="game-info">
                    <div class="level-info">关卡: <span>5/7</span></div>
                    <div class="score-info">分数: <span id="scoreC">0</span></div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar" id="levelC-progress" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="content">
                <div class="question-container">
                    <div class="question-text" id="questionC-text">17是质数还是合数？</div>
                    
                    <div class="options-container" id="optionsC-container">
                        <!-- 选项将通过JavaScript动态生成 -->
                    </div>
                    
                    <div class="feedback" id="feedbackC"></div>
                    
                    <div class="hint" id="hintC">
                        提示：检查17有哪些因数。17÷1=17，17÷2=8...1（有余数），17÷3=5...2（有余数），一直试到16都不能整除。所以17只有1和17两个因数，是质数。
                    </div>
                    
                    <button class="btn show-hint-btn" id="show-hintC-btn">显示提示</button>
                </div>
            </div>
            
            <div class="buttons-container">
                <button class="btn btn-secondary" id="back-to-lessonC-btn">返回教学</button>
                <button class="btn btn-primary" id="check-answerC-btn">检查答案</button>
                <button class="btn btn-primary" id="next-questionC-btn" style="display:none">下一题</button>
            </div>
        </div>
        
        <!-- 教学关卡3：最大公约数 -->
        <div id="lesson3-screen" class="screen">
            <div class="header">
                <h2>第六课：认识最大公约数</h2>
                <div class="progress-container">
                    <div class="progress-bar" id="progress3" style="width: 85%"></div>
                </div>
            </div>
            
            <div class="content">
                <div class="lesson-content">
                    <p><strong>公约数的定义：</strong>两个或多个数公有的因数叫做这几个数的公约数。</p>
                    
                    <div class="example">
                        <p class="example-title">例子：</p>
                        <p>12的因数有：1, 2, 3, 4, 6, 12</p>
                        <p>18的因数有：1, 2, 3, 6, 9, 18</p>
                        <p>12和18公有的因数有：1, 2, 3, 6</p>
                        <p>所以12和18的公约数是1, 2, 3, 6</p>
                    </div>
                    
                    <p><strong>最大公约数的定义：</strong>两个或多个数的公约数中最大的一个。</p>
                    <p><strong>注意：</strong>最小公约数总是1，所以我们通常说的是最大公约数。</p>
                    
                    <div class="example">
                        <p class="example-title">找出8和12的最大公约数：</p>
                        <p>8的因数有：1, 2, 4, 8</p>
                        <p>12的因数有：1, 2, 3, 4, 6, 12</p>
                        <p>8和12公有的因数有：1, 2, 4</p>
                        <p>最大的公约数是4</p>
                        <p>所以8和12的最大公约数是4</p>
                    </div>
                    
                    <p>在接下来的练习中，你会练习找出两个数的最大公约数。</p>
                </div>
            </div>
            
            <div class="buttons-container">
                <button class="btn btn-secondary" id="back-to-levelC-btn">返回上一关</button>
                <button class="btn btn-primary" id="start-level3-btn">开始练习</button>
            </div>
        </div>
        
        <!-- 关卡3：最大公约数练习 -->
        <div id="level3-screen" class="screen">
            <div class="header">
                <h2>第六关：最大公约数练习</h2>
                <div class="game-info">
                    <div class="level-info">关卡: <span>6/7</span></div>
                    <div class="score-info">分数: <span id="score3">0</span></div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar" id="level3-progress" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="content">
                <div class="question-container">
                    <div class="question-text" id="question3-text">16和24的最大公约数是多少？</div>
                    
                    <div class="options-container" id="options3-container">
                        <!-- 选项将通过JavaScript动态生成 -->
                    </div>
                    
                    <div class="feedback" id="feedback3"></div>
                    
                    <div class="hint" id="hint3">
                        提示：先找出16的因数：1, 2, 4, 8, 16。再找出24的因数：1, 2, 3, 4, 6, 8, 12, 24。两个数公有的因数有：1, 2, 4, 8。最大的公约数是8。
                    </div>
                    
                    <button class="btn show-hint-btn" id="show-hint3-btn">显示提示</button>
                </div>
            </div>
            
            <div class="buttons-container">
                <button class="btn btn-secondary" id="back-to-lesson3-btn">返回教学</button>
                <button class="btn btn-primary" id="check-answer3-btn">检查答案</button>
                <button class="btn btn-primary" id="next-question3-btn" style="display:none">下一题</button>
            </div>
        </div>
        
        <!-- 关卡4：综合挑战 -->
        <div id="level4-screen" class="screen">
            <div class="header">
                <h2>第七关：综合挑战</h2>
                <div class="game-info">
                    <div class="level-info">关卡: <span>7/7</span></div>
                    <div class="score-info">分数: <span id="score4">0</span></div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar" id="level4-progress" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="content">
                <div class="question-container">
                    <div class="question-text" id="question4-text">下面哪个数是15的倍数，同时也是20的因数？</div>
                    
                    <div class="options-container" id="options4-container">
                        <!-- 选项将通过JavaScript动态生成 -->
                    </div>
                    
                    <div class="feedback" id="feedback4"></div>
                    
                    <div class="hint" id="hint4">
                        提示：先找出15的倍数（15, 30, 45, 60...），再找出20的因数（1, 2, 4, 5, 10, 20）。看看哪个数既是15的倍数又是20的因数。
                    </div>
                    
                    <button class="btn show-hint-btn" id="show-hint4-btn">显示提示</button>
                </div>
            </div>
            
            <div class="buttons-container">
                <button class="btn btn-secondary" id="back-to-level3-btn">返回上一关</button>
                <button class="btn btn-primary" id="check-answer4-btn">检查答案</button>
                <button class="btn btn-primary" id="next-question4-btn" style="display:none">下一题</button>
            </div>
        </div>
        
        <!-- 完成屏幕 -->
        <div id="completion-screen" class="screen">
            <div class="header">
                <h2>恭喜完成所有关卡！</h2>
                <div class="character">🏆</div>
                <div class="celebration">🎉</div>
            </div>
            
            <div class="content completion-screen">
                <div class="final-score" id="final-score">你的得分: 0/100</div>
                
                <div class="lesson-content" style="text-align: left;">
                    <p>你已成功完成数学冒险岛的所有挑战！</p>
                    <p>通过这个游戏，你已经掌握了：</p>
                    <ul style="margin: 20px; padding-left: 20px;">
                        <li>倍数的概念和如何找出倍数</li>
                        <li>因数的概念和如何找出因数（包括1和数字本身）</li>
                        <li>如何找出一个数的所有因数</li>
                        <li>如何判断一个数有多少个因数</li>
                        <li>质数和合数的概念和判断方法</li>
                        <li>公约数和最大公约数的概念和计算方法</li>
                        <li>100以内数的常见数学关系</li>
                    </ul>
                    <p>继续练习，你会成为数学小达人！</p>
                </div>
            </div>
            
            <div class="buttons-container">
                <button class="btn btn-secondary" id="back-to-level4-btn">返回上一关</button>
                <button class="btn btn-primary" id="restart-game-btn">重新开始游戏</button>
            </div>
        </div>
    </div>

    <script>
        // 游戏状态 - 修正并扩展的题库
        const gameState = {
            currentLevel: 1,
            currentQuestion: 0,
            scores: [0, 0, 0, 0, 0, 0, 0], // 每个关卡的分数
            questions: [
                // 关卡1: 倍数
                [
                    {
                        question: "下面哪个数是6的倍数？",
                        options: ["14", "18", "22", "26", "30", "34"],
                        correct: [1, 4], // 18和30是6的倍数
                        type: "multiple"
                    },
                    {
                        question: "下面哪个数是9的倍数？",
                        options: ["27", "36", "45", "54", "63", "70"],
                        correct: [0, 1, 2, 3, 4], // 27,36,45,54,63是9的倍数
                        type: "multiple"
                    },
                    {
                        question: "下面哪个数是7的倍数？",
                        options: ["21", "28", "35", "42", "49", "56"],
                        correct: [0, 1, 2, 3, 4, 5], // 全部都是7的倍数
                        type: "multiple"
                    }
                ],
                // 关卡2: 因数 - 修正：确保包含1和数字本身
                [
                    {
                        question: "下面哪个数是36的因数？",
                        options: ["1", "4", "6", "9", "12", "36"],
                        correct: [0, 1, 2, 3, 4, 5], // 1,4,6,9,12,36都是36的因数
                        type: "multiple"
                    },
                    {
                        question: "下面哪个数是48的因数？",
                        options: ["1", "3", "6", "8", "12", "48"],
                        correct: [0, 1, 2, 3, 4, 5], // 1,3,6,8,12,48都是48的因数
                        type: "multiple"
                    },
                    {
                        question: "下面哪个数是60的因数？",
                        options: ["1", "5", "10", "15", "20", "60"],
                        correct: [0, 1, 2, 3, 4, 5], // 1,5,10,15,20,60都是60的因数
                        type: "multiple"
                    }
                ],
                // 关卡A: 找出一个数的所有因数
                [
                    {
                        question: "找出10的所有因数：",
                        options: ["1, 2, 5", "1, 2, 5, 10", "1, 2, 10", "2, 5, 10"],
                        correct: [1], // 1, 2, 5, 10
                        type: "single"
                    },
                    {
                        question: "找出17的所有因数：",
                        options: ["1, 17", "1, 7, 17", "1, 17, 34", "17"],
                        correct: [0], // 1, 17
                        type: "single"
                    },
                    {
                        question: "找出28的所有因数：",
                        options: ["1, 2, 4, 7, 14, 28", "1, 2, 4, 7, 28", "1, 2, 14, 28", "2, 4, 7, 14, 28"],
                        correct: [0], // 1, 2, 4, 7, 14, 28
                        type: "single"
                    },
                    {
                        question: "找出32的所有因数：",
                        options: ["1, 2, 4, 8, 16, 32", "1, 2, 4, 8, 32", "1, 2, 16, 32", "2, 4, 8, 16, 32"],
                        correct: [0], // 1, 2, 4, 8, 16, 32
                        type: "single"
                    },
                    {
                        question: "找出48的所有因数：",
                        options: ["1, 2, 3, 4, 6, 8, 12, 16, 24, 48", "1, 2, 3, 4, 6, 8, 12, 16, 48", "1, 2, 3, 4, 6, 8, 12, 24, 48", "1, 2, 3, 4, 6, 8, 12, 16, 24, 48"],
                        correct: [3], // 1, 2, 3, 4, 6, 8, 12, 16, 24, 48
                        type: "single"
                    }
                ],
                // 关卡B: 判断一个数有多少个因数
                [
                    {
                        question: "10有多少个因数？",
                        options: ["3个", "4个", "5个", "6个"],
                        correct: [1], // 4个 (1, 2, 5, 10)
                        type: "single"
                    },
                    {
                        question: "12有多少个因数？",
                        options: ["4个", "5个", "6个", "7个"],
                        correct: [2], // 6个 (1, 2, 3, 4, 6, 12)
                        type: "single"
                    },
                    {
                        question: "16有多少个因数？",
                        options: ["4个", "5个", "6个", "7个"],
                        correct: [1], // 5个 (1, 2, 4, 8, 16)
                        type: "single"
                    },
                    {
                        question: "24有多少个因数？",
                        options: ["6个", "7个", "8个", "9个"],
                        correct: [2], // 8个 (1, 2, 3, 4, 6, 8, 12, 24)
                        type: "single"
                    },
                    {
                        question: "36有多少个因数？",
                        options: ["7个", "8个", "9个", "10个"],
                        correct: [2], // 9个 (1, 2, 3, 4, 6, 9, 12, 18, 36)
                        type: "single"
                    }
                ],
                // 关卡C: 判断质数还是合数
                [
                    {
                        question: "17是质数还是合数？",
                        options: ["质数", "合数"],
                        correct: [0], // 质数
                        type: "single"
                    },
                    {
                        question: "21是质数还是合数？",
                        options: ["质数", "合数"],
                        correct: [1], // 合数 (3×7=21)
                        type: "single"
                    },
                    {
                        question: "29是质数还是合数？",
                        options: ["质数", "合数"],
                        correct: [0], // 质数
                        type: "single"
                    },
                    {
                        question: "51是质数还是合数？",
                        options: ["质数", "合数"],
                        correct: [1], // 合数 (3×17=51)
                        type: "single"
                    },
                    {
                        question: "91是质数还是合数？",
                        options: ["质数", "合数"],
                        correct: [1], // 合数 (7×13=91)
                        type: "single"
                    }
                ],
                // 关卡3: 最大公约数 - 修正：改为最大公约数
                [
                    {
                        question: "8和12的最大公约数是多少？",
                        options: ["1", "2", "4", "6", "8", "12"],
                        correct: [2], // 4是最大公约数
                        type: "single"
                    },
                    {
                        question: "9和15的最大公约数是多少？",
                        options: ["1", "3", "5", "9", "15", "45"],
                        correct: [1], // 3是最大公约数
                        type: "single"
                    },
                    {
                        question: "16和24的最大公约数是多少？",
                        options: ["1", "2", "4", "8", "16", "24"],
                        correct: [3], // 8是最大公约数
                        type: "single"
                    }
                ],
                // 关卡4: 综合挑战
                [
                    {
                        question: "下面哪个数是15的倍数，同时也是20的因数？",
                        options: ["5", "10", "15", "30", "60", "100"],
                        correct: [0, 1], // 5和10都是
                        type: "multiple"
                    },
                    {
                        question: "下面哪个数既是8的倍数，又是12的因数？",
                        options: ["1", "2", "4", "8", "12", "24"],
                        correct: [2, 4], // 4和12都是
                        type: "multiple"
                    },
                    {
                        question: "下面哪个数是3和5的公倍数，且小于50？",
                        options: ["15", "30", "45", "10", "25", "40"],
                        correct: [0, 1, 2], // 15,30,45都是
                        type: "multiple"
                    }
                ]
            ],
            selectedOptions: []
        };

        // 音频元素
        let correctSound, wrongSound, clickSound;

        // 初始化游戏
        function initGame() {
            // 创建音频元素
            correctSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3');
            wrongSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3');
            clickSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3');
            
            // 设置按钮事件监听器
            setupEventListeners();
            
            // 初始化第一关的问题
            loadQuestion(1, 0);
        }

        // 设置所有按钮的事件监听器
        function setupEventListeners() {
            // 开始屏幕按钮
            document.getElementById('start-game-btn').addEventListener('click', startGame);
            document.getElementById('instructions-btn').addEventListener('click', showInstructions);
            
            // 说明屏幕按钮
            document.getElementById('back-to-start-btn').addEventListener('click', showStartScreen);
            
            // 教学关卡1按钮
            document.getElementById('back-from-lesson1-btn').addEventListener('click', showStartScreen);
            document.getElementById('start-level1-btn').addEventListener('click', () => startLevel(1));
            
            // 关卡1按钮
            document.getElementById('back-to-lesson1-btn').addEventListener('click', () => showLesson(1));
            document.getElementById('check-answer1-btn').addEventListener('click', () => checkAnswer(1));
            document.getElementById('next-question1-btn').addEventListener('click', () => nextQuestion(1));
            document.getElementById('show-hint1-btn').addEventListener('click', () => toggleHint(1));
            
            // 教学关卡2按钮
            document.getElementById('back-to-level1-btn').addEventListener('click', () => showLevel(1));
            document.getElementById('start-level2-btn').addEventListener('click', () => startLevel(2));
            
            // 关卡2按钮
            document.getElementById('back-to-lesson2-btn').addEventListener('click', () => showLesson(2));
            document.getElementById('check-answer2-btn').addEventListener('click', () => checkAnswer(2));
            document.getElementById('next-question2-btn').addEventListener('click', () => nextQuestion(2));
            document.getElementById('show-hint2-btn').addEventListener('click', () => toggleHint(2));
            
            // 关卡A按钮
            document.getElementById('back-to-level2-btn').addEventListener('click', () => showLevel(2));
            document.getElementById('check-answerA-btn').addEventListener('click', () => checkAnswer('A'));
            document.getElementById('next-questionA-btn').addEventListener('click', () => nextQuestion('A'));
            document.getElementById('show-hintA-btn').addEventListener('click', () => toggleHint('A'));
            
            // 关卡B按钮
            document.getElementById('back-to-levelA-btn').addEventListener('click', () => showLevel('A'));
            document.getElementById('check-answerB-btn').addEventListener('click', () => checkAnswer('B'));
            document.getElementById('next-questionB-btn').addEventListener('click', () => nextQuestion('B'));
            document.getElementById('show-hintB-btn').addEventListener('click', () => toggleHint('B'));
            
            // 教学关卡C按钮
            document.getElementById('back-to-levelB-btn').addEventListener('click', () => showLevel('B'));
            document.getElementById('start-levelC-btn').addEventListener('click', () => startLevel('C'));
            
            // 关卡C按钮
            document.getElementById('back-to-lessonC-btn').addEventListener('click', () => showLesson('C'));
            document.getElementById('check-answerC-btn').addEventListener('click', () => checkAnswer('C'));
            document.getElementById('next-questionC-btn').addEventListener('click', () => nextQuestion('C'));
            document.getElementById('show-hintC-btn').addEventListener('click', () => toggleHint('C'));
            
            // 教学关卡3按钮
            document.getElementById('back-to-levelC-btn').addEventListener('click', () => showLevel('C'));
            document.getElementById('start-level3-btn').addEventListener('click', () => startLevel(3));
            
            // 关卡3按钮
            document.getElementById('back-to-lesson3-btn').addEventListener('click', () => showLesson(3));
            document.getElementById('check-answer3-btn').addEventListener('click', () => checkAnswer(3));
            document.getElementById('next-question3-btn').addEventListener('click', () => nextQuestion(3));
            document.getElementById('show-hint3-btn').addEventListener('click', () => toggleHint(3));
            
            // 关卡4按钮
            document.getElementById('back-to-level3-btn').addEventListener('click', () => showLevel(3));
            document.getElementById('check-answer4-btn').addEventListener('click', () => checkAnswer(4));
            document.getElementById('next-question4-btn').addEventListener('click', () => nextQuestion(4));
            document.getElementById('show-hint4-btn').addEventListener('click', () => toggleHint(4));
            
            // 完成屏幕按钮
            document.getElementById('back-to-level4-btn').addEventListener('click', () => showLevel(4));
            document.getElementById('restart-game-btn').addEventListener('click', restartGame);
        }

        // 播放音效
        function playSound(sound) {
            sound.currentTime = 0;
            sound.play().catch(e => console.log("音效播放失败:", e));
        }

        // 显示开始屏幕
        function showStartScreen() {
            hideAllScreens();
            document.getElementById('start-screen').classList.add('active-screen');
            playSound(clickSound);
        }

        // 显示游戏说明
        function showInstructions() {
            hideAllScreens();
            document.getElementById('instructions-screen').classList.add('active-screen');
            playSound(clickSound);
        }

        // 开始游戏
        function startGame() {
            showLesson(1);
            playSound(clickSound);
        }

        // 显示教学关卡
        function showLesson(lessonNumber) {
            hideAllScreens();
            document.getElementById(`lesson${lessonNumber}-screen`).classList.add('active-screen');
            playSound(clickSound);
        }

        // 显示关卡
        function showLevel(levelNumber) {
            hideAllScreens();
            document.getElementById(`level${levelNumber}-screen`).classList.add('active-screen');
            playSound(clickSound);
        }

        // 开始关卡
        function startLevel(levelNumber) {
            // 将关卡标识转换为索引
            let levelIndex;
            if (levelNumber === 'A') levelIndex = 2;
            else if (levelNumber === 'B') levelIndex = 3;
            else if (levelNumber === 'C') levelIndex = 4;
            else if (levelNumber === 3) levelIndex = 6;
            else if (levelNumber === 4) levelIndex = 7;
            else levelIndex = levelNumber - 1;
            
            gameState.currentLevel = levelIndex;
            gameState.currentQuestion = 0;
            gameState.selectedOptions = [];
            loadQuestion(levelIndex, 0);
            showLevel(levelIndex);
            playSound(clickSound);
        }

        // 隐藏所有屏幕
        function hideAllScreens() {
            const screens = document.querySelectorAll('.screen');
            screens.forEach(screen => {
                screen.classList.remove('active-screen');
            });
        }

        // 加载问题
        function loadQuestion(levelIndex, questionIndex) {
            // 确定显示哪个关卡屏幕
            let screenLevel;
            if (levelIndex === 0) screenLevel = 1;
            else if (levelIndex === 1) screenLevel = 2;
            else if (levelIndex === 2) screenLevel = 'A';
            else if (levelIndex === 3) screenLevel = 'B';
            else if (levelIndex === 4) screenLevel = 'C';
            else if (levelIndex === 5) screenLevel = 3;
            else if (levelIndex === 6) screenLevel = 4;
            
            const question = gameState.questions[levelIndex][questionIndex];
            
            // 更新问题文本
            document.getElementById(`question${screenLevel}-text`).textContent = question.question;
            
            // 更新进度条
            const progress = ((questionIndex + 1) / gameState.questions[levelIndex].length) * 100;
            document.getElementById(`level${screenLevel}-progress`).style.width = `${progress}%`;
            
            // 生成选项
            const optionsContainer = document.getElementById(`options${screenLevel}-container`);
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                optionElement.dataset.index = index;
                
                optionElement.addEventListener('click', () => {
                    playSound(clickSound);
                    selectOption(screenLevel, index, question.type);
                });
                
                optionsContainer.appendChild(optionElement);
            });
            
            // 重置反馈和按钮状态
            document.getElementById(`feedback${screenLevel}`).style.display = 'none';
            document.getElementById(`check-answer${screenLevel}-btn`).style.display = 'inline-block';
            document.getElementById(`next-question${screenLevel}-btn`).style.display = 'none';
            document.getElementById(`hint${screenLevel}`).style.display = 'none';
            
            // 重置选择状态
            gameState.selectedOptions = [];
        }

        // 选择选项
        function selectOption(screenLevel, optionIndex, type) {
            const options = document.querySelectorAll(`#options${screenLevel}-container .option`);
            
            if (type === 'single') {
                // 单选：清除所有选择，选择当前项
                options.forEach(option => {
                    option.classList.remove('selected');
                });
                options[optionIndex].classList.add('selected');
                gameState.selectedOptions = [optionIndex];
            } else {
                // 多选：切换选择状态
                options[optionIndex].classList.toggle('selected');
                
                // 更新已选择的选项
                gameState.selectedOptions = [];
                options.forEach((option, index) => {
                    if (option.classList.contains('selected')) {
                        gameState.selectedOptions.push(index);
                    }
                });
            }
        }

        // 检查答案
        function checkAnswer(screenLevel) {
            // 确定关卡索引
            let levelIndex;
            if (screenLevel === 1) levelIndex = 0;
            else if (screenLevel === 2) levelIndex = 1;
            else if (screenLevel === 'A') levelIndex = 2;
            else if (screenLevel === 'B') levelIndex = 3;
            else if (screenLevel === 'C') levelIndex = 4;
            else if (screenLevel === 3) levelIndex = 6;
            else if (screenLevel === 4) levelIndex = 7;
            
            const questionIndex = gameState.currentQuestion;
            const question = gameState.questions[levelIndex][questionIndex];
            const feedback = document.getElementById(`feedback${screenLevel}`);
            const options = document.querySelectorAll(`#options${screenLevel}-container .option`);
            
            // 检查是否选择了答案
            if (gameState.selectedOptions.length === 0) {
                feedback.textContent = "请先选择一个答案！";
                feedback.className = "feedback wrong";
                feedback.style.display = "block";
                playSound(wrongSound);
                return;
            }
            
            // 检查答案是否正确
            let isCorrect = true;
            
            // 检查是否选择了所有正确选项，并且没有选择错误选项
            if (question.correct.length !== gameState.selectedOptions.length) {
                isCorrect = false;
            } else {
                for (let i = 0; i < question.correct.length; i++) {
                    if (!gameState.selectedOptions.includes(question.correct[i])) {
                        isCorrect = false;
                        break;
                    }
                }
            }
            
            // 显示正确答案
            question.correct.forEach(correctIndex => {
                options[correctIndex].classList.add('correct');
            });
            
            // 显示错误答案
            gameState.selectedOptions.forEach(selectedIndex => {
                if (!question.correct.includes(selectedIndex)) {
                    options[selectedIndex].classList.add('wrong');
                    isCorrect = false;
                }
            });
            
            // 显示反馈
            if (isCorrect) {
                feedback.textContent = "回答正确！太棒了！";
                feedback.className = "feedback correct";
                gameState.scores[levelIndex] += 10;
                document.getElementById(`score${screenLevel}`).textContent = gameState.scores[levelIndex];
                playSound(correctSound);
            } else {
                feedback.textContent = "回答错误，再试一次！";
                feedback.className = "feedback wrong";
                playSound(wrongSound);
            }
            
            feedback.style.display = "block";
            
            // 更新按钮状态
            document.getElementById(`check-answer${screenLevel}-btn`).style.display = 'none';
            document.getElementById(`next-question${screenLevel}-btn`).style.display = 'inline-block';
        }

        // 下一题
        function nextQuestion(screenLevel) {
            // 确定关卡索引
            let levelIndex;
            if (screenLevel === 1) levelIndex = 0;
            else if (screenLevel === 2) levelIndex = 1;
            else if (screenLevel === 'A') levelIndex = 2;
            else if (screenLevel === 'B') levelIndex = 3;
            else if (screenLevel === 'C') levelIndex = 4;
            else if (screenLevel === 3) levelIndex = 6;
            else if (screenLevel === 4) levelIndex = 7;
            
            gameState.currentQuestion++;
            
            // 检查是否还有更多问题
            if (gameState.currentQuestion < gameState.questions[levelIndex].length) {
                loadQuestion(levelIndex, gameState.currentQuestion);
            } else {
                // 检查是否是最后一关
                if (levelIndex < 7) {
                    // 根据当前关卡确定下一个关卡
                    let nextLevel;
                    if (levelIndex === 0) nextLevel = 2; // 关卡1 -> 关卡2
                    else if (levelIndex === 1) nextLevel = 'A'; // 关卡2 -> 关卡A
                    else if (levelIndex === 2) nextLevel = 'B'; // 关卡A -> 关卡B
                    else if (levelIndex === 3) nextLevel = 'C'; // 关卡B -> 教学C
                    else if (levelIndex === 4) showLesson(3); // 关卡C -> 教学3
                    else if (levelIndex === 5) showLesson(3); // 教学C已处理
                    else if (levelIndex === 6) startLevel(4); // 关卡3 -> 关卡4
                    
                    if (levelIndex === 4) {
                        // 关卡C完成后显示教学关卡3
                        showLesson(3);
                    } else if (nextLevel === 'C') {
                        // 关卡B完成后显示教学关卡C
                        showLesson('C');
                    } else if (nextLevel) {
                        startLevel(nextLevel);
                    }
                } else {
                    // 显示完成屏幕
                    showCompletionScreen();
                }
            }
            
            playSound(clickSound);
        }

        // 切换提示显示
        function toggleHint(level) {
            const hint = document.getElementById(`hint${level}`);
            const hintBtn = document.getElementById(`show-hint${level}-btn`);
            
            if (hint.style.display === 'none' || hint.style.display === '') {
                hint.style.display = 'block';
                hintBtn.textContent = '隐藏提示';
            } else {
                hint.style.display = 'none';
                hintBtn.textContent = '显示提示';
            }
            
            playSound(clickSound);
        }

        // 显示完成屏幕
        function showCompletionScreen() {
            // 计算总分
            const totalScore = gameState.scores.reduce((sum, score) => sum + score, 0);
            document.getElementById('final-score').textContent = `你的得分: ${totalScore}/100`;
            
            hideAllScreens();
            document.getElementById('completion-screen').classList.add('active-screen');
            playSound(correctSound);
        }

        // 重新开始游戏
        function restartGame() {
            // 重置游戏状态
            gameState.currentLevel = 0;
            gameState.currentQuestion = 0;
            gameState.scores = [0, 0, 0, 0, 0, 0, 0];
            gameState.selectedOptions = [];
            
            // 重置分数显示
            for (let i = 1; i <= 4; i++) {
                document.getElementById(`score${i}`).textContent = '0';
            }
            document.getElementById('scoreA').textContent = '0';
            document.getElementById('scoreB').textContent = '0';
            document.getElementById('scoreC').textContent = '0';
            
            // 重新加载第一题
            loadQuestion(0, 0);
            
            // 显示开始屏幕
            showStartScreen();
            playSound(clickSound);
        }

        // 页面加载完成后初始化游戏
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
